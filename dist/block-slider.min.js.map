{"version":3,"sources":["block-slider.js"],"names":["BlockSlider","collection","_ref","testTiming","timing","console","warn","lgStart","cache","slider","wrap","undefined","items","duration","sliderName","id","className","msg2","querySelector","wrapClass","Error","itemsClass","slice","call","children","e","message","calcTransiton","setAttribute","sliders","push","slidePosition","itemsPerSlide","itemWidth","wrapWidth","sliderWidth","slide","direction","mouseOver","forEach","s","hasReachedEnd","hasReachedStart","str","style","webkitTransform","msTransform","transform","calcAndSetWidths","removeInlineWidths","opacity","removeProperty","item","i","arr","setWidths","width","length","offsetWidth","calcItemWidth","calcItemsPerSlide","Math","round","setTimeout","safariFixDelay","handleTouchStart","evt","xDown","touches","clientX","handleTouchMove","preventDefault","xUp","xDiff","stopForever","_ref$sInterval","sInterval","_ref$sTransition","sTransition","_ref$wrapClass","_ref$itemsClass","_ref$stopAfterNavigate","stopAfterNavigate","test","window","HTMLElement","resizeTimer","addEventListener","clearTimeout","setInterval","requestAnimationFrame","jQuery","$","fn","opts","this"],"mappings":"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","file":"block-slider.min.js","sourcesContent":["function BlockSlider(collection, {\r\n    sInterval = 2000,\r\n    sTransition = 400,\r\n    wrapClass = '.js-block-slider__wrap',\r\n    itemsClass = '.js-block-slider__items',\r\n    stopAfterNavigate = true // when true, autoslide stops after navigation\r\n}) {\r\n    'use strict';\r\n    const safariFixDelay = /constructor/i.test(window.HTMLElement) ? 500 : 0,\r\n        sliders = [],\r\n        lgStart = 'Block Slider: ';\r\n    let resizeTimer;\r\n    let mouseOver = false;\r\n    let stopForever = false; \r\n\r\n    function testTiming(timing) {\r\n        if (typeof timing !== 'number') {\r\n            console.warn(`${lgStart}Supplied timing: '${timing}' is not an integer`);\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    if (! testTiming(sInterval)) {\r\n        sInterval = 2000;\r\n    }\r\n    if (! testTiming(sTransition)) {\r\n        sTransition = 400;\r\n    }\r\n    \r\n    try {\r\n        // can collection be found ?\r\n        if (!collection || !collection.length && !collection.querySelector) {\r\n            throw new Error(`${lgStart}Supplied slider(s) could not be found.`);\r\n        }\r\n    }\r\n    catch(e) {\r\n        console.warn(e.message);\r\n        return;\r\n    }\r\n\r\n    const calcTransiton = () => sTransition / 1000;\r\n\r\n    function cache(slider) {\r\n        let wrap,\r\n            items,\r\n            duration,\r\n            sliderName = slider.id ? '#' + slider.id : '.' + slider.className,\r\n            msg2 = ' could not be found as a direct descendant of ';\r\n        try {\r\n            wrap = slider.querySelector(wrapClass);\r\n            if (!wrap) {\r\n                throw new Error(`${lgStart}'${wrapClass}'${msg2}'${sliderName}.'`);\r\n            } \r\n            else {\r\n                items = wrap.querySelector(itemsClass);\r\n                if (!items) {\r\n                    throw new Error(`${lgStart}'${itemsClass}'${msg2}'${wrapClass}.'`);\r\n                } \r\n                else {\r\n                    items = [].slice.call(items.children, 0);                    \r\n                }\r\n            }\r\n        } \r\n        catch(e) {\r\n            console.warn(e.message);\r\n            return false;\r\n        }\r\n        duration = calcTransiton();\r\n        slider.setAttribute('style', 'opacity: 0');\r\n        slider.querySelector('.block-area').setAttribute('style', 'overflow: hidden;');\r\n        wrap.setAttribute('style', `-webkit-transition: -webkit-transform ${duration}s;transition: transform ${duration}s;`);\r\n        sliders.push({\r\n            slider,\r\n            wrap,\r\n            items,\r\n            slidePosition: 0,\r\n            itemsPerSlide: 0,\r\n            itemWidth: 0,\r\n            wrapWidth: 0,\r\n            sliderWidth: 0\r\n        });\r\n    }\r\n    if (collection.length) {\r\n        [].forEach.call(collection, cache);\r\n    } else {\r\n        cache(collection);\r\n    }\r\n\r\n    const hasReachedEnd = s => -(s.slidePosition + 1) > s.wrapWidth - s.sliderWidth;\r\n    const hasReachedStart = s => s.slidePosition > 1;\r\n\r\n    function slide(direction) {\r\n        if(mouseOver) return;\r\n        sliders.forEach(s => {\r\n            if(direction == 'next'){\r\n                s.slidePosition -= s.itemWidth;\r\n            }else{\r\n                s.slidePosition += s.itemWidth;\r\n            }\r\n            if (hasReachedEnd(s)) s.slidePosition = 0; // return to start\r\n            if (hasReachedStart(s)) s.slidePosition = -(s.wrapWidth - s.sliderWidth) + 15; // return to end\r\n            const wrap = s.wrap,\r\n                str = `translate3d(${s.slidePosition}px, 0, 0)`;\r\n            wrap.style.webkitTransform = str;\r\n            wrap.style.msTransform = str;\r\n            wrap.style.transform = str;\r\n        });\r\n    }\r\n\r\n    function calcAndSetWidths() {\r\n        function removeInlineWidths(s) {\r\n            // Temporarily hide the slider\r\n            s.slider.style.opacity = 0;\r\n            // Remove widths for wrap and all items.\r\n            s.wrap.style.removeProperty('width');\r\n            s.items.forEach((item, i, arr) => {\r\n                item.style.removeProperty('width');\r\n            });\r\n        }\r\n\r\n        const calcItemWidth = s => s.items[0].offsetWidth;\r\n\r\n        const calcItemsPerSlide = s => Math.round(s.sliderWidth / s.itemWidth);\r\n\r\n        function setWidths(s) {\r\n            // loop through all items and set their width in pixels\r\n            // to the calculated width.\r\n            s.items.forEach((item) => {\r\n                item.style.width = s.itemWidth + 'px';\r\n            });\r\n            // Set wrap width equal to total width of items.\r\n            s.wrapWidth = s.itemWidth * s.items.length;\r\n            s.wrap.style.width = s.wrapWidth + 'px';\r\n            s.sliderWidth = s.slider.offsetWidth;\r\n        }\r\n\r\n        sliders.forEach(s => {\r\n            removeInlineWidths(s);\r\n            // create a slight delay for Safari being rubbishly slow at layout calcs.\r\n            setTimeout(() => {\r\n                // get the default CSS item width in pixels.\r\n                s.itemWidth = calcItemWidth(s);\r\n                setWidths(s);\r\n                s.itemsPerSlide = calcItemsPerSlide(s);\r\n                s.slidePosition = 0;\r\n                setTimeout(() => {\r\n                    // fade slider back in.\r\n                    s.slider.style.opacity = 1;\r\n                    slide('next');\r\n                }, safariFixDelay);\r\n            }, safariFixDelay);\r\n        });\r\n    }\r\n\r\n    calcAndSetWidths();\r\n\r\n    window.addEventListener('resize', () => {\r\n        // call setWidths once the screen has finished resizing.\r\n        clearTimeout(resizeTimer);\r\n        resizeTimer = setTimeout(calcAndSetWidths, 250);\r\n    });\r\n\r\n    collection.querySelector('.block-area').addEventListener('mouseover', () => {\r\n        // pause slider on mouseover\r\n        mouseOver = true;\r\n    });\r\n\r\n    collection.addEventListener('mouseout', () => {\r\n        // start slider on mouseout\r\n        mouseOver = false;\r\n    });\r\n\r\n    collection.querySelector('.block-back').addEventListener('click',function(e){\r\n        slide('back',sliders);\r\n        stopForever = true;\r\n    });\r\n    collection.querySelector('.block-next').addEventListener('click',function(e){\r\n        slide('next',sliders);\r\n        stopForever = true;\r\n    });\r\n\r\n    //touch events\r\n    collection.addEventListener('touchstart', handleTouchStart, false);        \r\n    collection.addEventListener('touchmove', handleTouchMove, false);\r\n\r\n    let xDown = null;\r\n\r\n    function handleTouchStart(evt) {   \r\n        // save start position of swipe\r\n        xDown = evt.touches[0].clientX; \r\n    }                                        \r\n    function handleTouchMove(evt) {\r\n        evt.preventDefault(); // disable scrolling\r\n        // when touch is released\r\n        if ( ! xDown ) {\r\n            return;\r\n        }\r\n\r\n        let xUp = evt.touches[0].clientX,                                    \r\n            xDiff = (xDown - xUp);\r\n\r\n        //calc direction of swipe\r\n        if ( xDiff > 0 ) {\r\n            // swipe left\r\n            stopForever = true;\r\n            slide('next',sliders);\r\n        } else {\r\n            // swipe right\r\n            stopForever = true;\r\n            slide('back',sliders);\r\n        }\r\n        xDown = null;\r\n    }\r\n    // http://stackoverflow.com/a/23230280/5490735\r\n\r\n    setInterval(() => {\r\n        if(stopForever && stopAfterNavigate) return;\r\n        if (requestAnimationFrame) {\r\n            requestAnimationFrame(() => {\r\n                slide('next',sliders);\r\n            });            \r\n        } else {\r\n            slide('next',sliders);\r\n        }\r\n    }, sInterval);\r\n\r\n}\r\n\r\n// if jQuery is present, create a plugin.\r\nif (window.jQuery) {\r\n    (($) => {\r\n        $.fn.BlockSlider = function(opts) {\r\n            BlockSlider(this, opts);\r\n            return this;\r\n        };\r\n    })(window.jQuery);\r\n}\r\n"]}