{"version":3,"sources":["block-slider.js"],"names":["BlockSlider","collection","_ref","testTiming","timing","console","warn","lgStart","cache","slider","wrap","undefined","items","duration","sliderName","id","className","msg2","querySelector","wrapClass","Error","itemsClass","slice","call","children","e","message","calcTransiton","setAttribute","sliders","push","slidePosition","itemsPerSlide","itemWidth","wrapWidth","sliderWidth","slide","mouseOver","forEach","s","str","style","webkitTransform","msTransform","transform","hasReachedEnd","calcAndSetWidths","removeInlineWidths","opacity","removeProperty","item","i","arr","setWidths","width","length","offsetWidth","calcItemWidth","calcItemsPerSlide","Math","round","setTimeout","safariFixDelay","handleTouchStart","evt","xDown","touches","clientX","yDown","clientY","handleTouchMove","xUp","yUp","xDiff","yDiff","abs","pauseOnce","_ref$sInterval","sInterval","_ref$sTransition","sTransition","_ref$wrapClass","_ref$itemsClass","test","window","HTMLElement","resizeTimer","addEventListener","clearTimeout","document","setInterval","requestAnimationFrame","jQuery","$","fn","opts","this"],"mappings":"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","file":"block-slider.min.js","sourcesContent":["function BlockSlider(collection, {\r\n    sInterval = 2000,\r\n    sTransition = 400,\r\n    wrapClass = '.js-block-slider__wrap',\r\n    itemsClass = '.js-block-slider__items'\r\n}) {\r\n    'use strict';\r\n    const safariFixDelay = /constructor/i.test(window.HTMLElement) ? 500 : 0,\r\n        sliders = [],\r\n        lgStart = 'Block Slider: ';\r\n    let resizeTimer;\r\n    let mouseOver = false;\r\n    let pauseOnce = false; //when true, auto slides will be skipped one\r\n\r\n    function testTiming(timing) {\r\n        if (typeof timing !== 'number') {\r\n            console.warn(`${lgStart}Supplied timing: '${timing}' is not an integer`);\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    if (! testTiming(sInterval)) {\r\n        sInterval = 2000;\r\n    }\r\n    if (! testTiming(sTransition)) {\r\n        sTransition = 400;\r\n    }\r\n    \r\n    try {\r\n        // can collection be found ?\r\n        if (!collection || !collection.length && !collection.querySelector) {\r\n            throw new Error(`${lgStart}Supplied slider(s) could not be found.`);\r\n        }\r\n    }\r\n    catch(e) {\r\n        console.warn(e.message);\r\n        return;\r\n    }\r\n\r\n    const calcTransiton = () => sTransition / 1000;\r\n\r\n    function cache(slider) {\r\n        let wrap,\r\n            items,\r\n            duration,\r\n            sliderName = slider.id ? '#' + slider.id : '.' + slider.className,\r\n            msg2 = ' could not be found as a direct descendant of ';\r\n        try {\r\n            wrap = slider.querySelector(wrapClass);\r\n            if (!wrap) {\r\n                throw new Error(`${lgStart}'${wrapClass}'${msg2}'${sliderName}.'`);\r\n            } \r\n            else {\r\n                items = wrap.querySelector(itemsClass);\r\n                if (!items) {\r\n                    throw new Error(`${lgStart}'${itemsClass}'${msg2}'${wrapClass}.'`);\r\n                } \r\n                else {\r\n                    items = [].slice.call(items.children, 0);                    \r\n                }\r\n            }\r\n        } \r\n        catch(e) {\r\n            console.warn(e.message);\r\n            return false;\r\n        }\r\n        duration = calcTransiton();\r\n        slider.setAttribute('style', 'overflow: hidden; opacity: 0');\r\n        wrap.setAttribute('style', `-webkit-transition: -webkit-transform ${duration}s;transition: transform ${duration}s;`);\r\n        sliders.push({\r\n            slider,\r\n            wrap,\r\n            items,\r\n            slidePosition: 0,\r\n            itemsPerSlide: 0,\r\n            itemWidth: 0,\r\n            wrapWidth: 0,\r\n            sliderWidth: 0\r\n        });\r\n    }\r\n    if (collection.length) {\r\n        [].forEach.call(collection, cache);\r\n    } else {\r\n        cache(collection);\r\n    }\r\n\r\n    const hasReachedEnd = s => -(s.slidePosition + 1) > s.wrapWidth - s.sliderWidth;\r\n\r\n    function slide() {\r\n        if(mouseOver) return;\r\n        sliders.forEach(s => {\r\n            const wrap = s.wrap,\r\n                str = `translate3d(${s.slidePosition}px, 0, 0)`;\r\n            wrap.style.webkitTransform = str;\r\n            wrap.style.msTransform = str;\r\n            wrap.style.transform = str;\r\n            s.slidePosition -= s.itemWidth;\r\n            if (hasReachedEnd(s)) {\r\n                s.slidePosition = 0;\r\n            }\r\n        });\r\n    }\r\n\r\n    function calcAndSetWidths() {\r\n        function removeInlineWidths(s) {\r\n            // Temporarily hide the slider\r\n            s.slider.style.opacity = 0;\r\n            // Remove widths for wrap and all items.\r\n            s.wrap.style.removeProperty('width');\r\n            s.items.forEach((item, i, arr) => {\r\n                item.style.removeProperty('width');\r\n            });\r\n        }\r\n\r\n        const calcItemWidth = s => s.items[0].offsetWidth;\r\n\r\n        const calcItemsPerSlide = s => Math.round(s.sliderWidth / s.itemWidth);\r\n\r\n        function setWidths(s) {\r\n            // loop through all items and set their width in pixels\r\n            // to the calculated width.\r\n            s.items.forEach((item) => {\r\n                item.style.width = s.itemWidth + 'px';\r\n            });\r\n            // Set wrap width equal to total width of items.\r\n            s.wrapWidth = s.itemWidth * s.items.length;\r\n            s.wrap.style.width = s.wrapWidth + 'px';\r\n            s.sliderWidth = s.slider.offsetWidth;\r\n        }\r\n\r\n        sliders.forEach(s => {\r\n            removeInlineWidths(s);\r\n            // create a slight delay for Safari being rubbishly slow at layout calcs.\r\n            setTimeout(() => {\r\n                // get the default CSS item width in pixels.\r\n                s.itemWidth = calcItemWidth(s);\r\n                setWidths(s);\r\n                s.itemsPerSlide = calcItemsPerSlide(s);\r\n                s.slidePosition = 0;\r\n                setTimeout(() => {\r\n                    // fade slider back in.\r\n                    s.slider.style.opacity = 1;\r\n                    slide();\r\n                }, safariFixDelay);\r\n            }, safariFixDelay);\r\n        });\r\n    }\r\n\r\n    calcAndSetWidths();\r\n\r\n    window.addEventListener('resize', () => {\r\n        // call setWidths once the screen has finished resizing.\r\n        clearTimeout(resizeTimer);\r\n        resizeTimer = setTimeout(calcAndSetWidths, 250);\r\n    });\r\n\r\n    collection.addEventListener('mouseover', () => {\r\n        //pause slider on mouseover\r\n        mouseOver = true;\r\n    });\r\n\r\n    collection.addEventListener('mouseout', () => {\r\n        //start slider on mouseout\r\n        mouseOver = false;\r\n    });\r\n\r\n    //touch events\r\n    document.addEventListener('touchstart', handleTouchStart, false);        \r\n    document.addEventListener('touchmove', handleTouchMove, false);\r\n\r\n    let xDown = null;                                                        \r\n    let yDown = null;                                                        \r\n\r\n    function handleTouchStart(evt) {                                         \r\n        //save start position of swipe\r\n        xDown = evt.touches[0].clientX;                                      \r\n        yDown = evt.touches[0].clientY;                                      \r\n    }                                        \r\n\r\n    function handleTouchMove(evt) {\r\n        //when touch is released\r\n        if ( ! xDown || ! yDown ) {\r\n            return;\r\n        }\r\n\r\n        let xUp = evt.touches[0].clientX;                                    \r\n        let yUp = evt.touches[0].clientY;\r\n\r\n        let xDiff = xDown - xUp;\r\n        let yDiff = yDown - yUp;\r\n\r\n        //calc direction of swipe\r\n        if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {\r\n            if ( xDiff > 0 ) {\r\n                //swipe left\r\n                pauseOnce = true;\r\n                slide(sliders);\r\n            } else {\r\n                //swipe right\r\n            }                       \r\n        } else {\r\n            if ( yDiff > 0 ) {\r\n                //swipe up\r\n            } else { \r\n                //swipe down\r\n            }                                                                 \r\n        }\r\n        xDown = null;\r\n        yDown = null;                                             \r\n    }\r\n    // http://stackoverflow.com/a/23230280/5490735\r\n\r\n    setInterval(() => {\r\n        if(!pauseOnce){\r\n            pauseOnce = true;\r\n            if (requestAnimationFrame) {\r\n                requestAnimationFrame(() => {\r\n                    slide(sliders);\r\n                });            \r\n            } else {\r\n                slide(sliders); \r\n            }\r\n        }else{\r\n            pauseOnce = false;\r\n        }\r\n    }, sInterval);\r\n\r\n}\r\n\r\n// if jQuery is present, create a plugin.\r\nif (window.jQuery) {\r\n    (($) => {\r\n        $.fn.BlockSlider = function(opts) {\r\n            BlockSlider(this, opts);\r\n            return this;\r\n        };\r\n    })(window.jQuery);\r\n}\r\n"]}